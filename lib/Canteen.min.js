!function(){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){var t,n,r=this;if("function"!=typeof r)throw new TypeError;return t=Array.prototype.slice.call(arguments,1),n=function(){if(this instanceof n){var i,o,a;return i=function(){},i.prototype=r.prototype,o=new i,a=r.apply(o,t.concat(Array.prototype.slice.call(arguments))),Object(a)===a?a:o}return r.apply(e,t.concat(Array.prototype.slice.call(arguments)))}})}(),function(e){"use strict";var t=function(e){var t=e.split("."),n=window,r="",i=0,o=0;for(i=0,o=t.length;o>i;i++)r=t[i],n[r]=n[r]||{},n=n[r];return n};e.namespace=t}(window),function(e,t){"use strict";function n(e,t){r.output&&r.output.append('<div class="'+e+'">'+t+"</div>")}var r=function(){},i=e.console!==t;r.GENERAL=0,r.DEBUG=1,r.INFO=2,r.WARN=3,r.ERROR=4,r.minLogLevel=r.GENERAL,r.enabled=!0,r.output=null,r.log=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&(console.log(e),n("general",e))},r.debug=function(e){r.minLogLevel<=r.DEBUG&&i&&r.enabled&&(console.debug(e),n("debug",e))},r.info=function(e){r.minLogLevel<=r.INFO&&i&&r.enabled&&(console.info(e),n("info",e))},r.warn=function(e){r.minLogLevel<=r.WARN&&i&&r.enabled&&(console.warn(e),n("warn",e))},r.error=function(e){i&&r.enabled&&(console.error(e),n("error",e))},r.fatalError=function(e){var t=e.message+"\non "+e.file+" (code: "+e.code+")\n";if(e.stackTrace)for(var n=0;n<e.stackTrace.length;n++)t+="\n	 #"+(n+1)+". "+e.stackTrace[n];r.error(t)},r.assert=function(e,o){i&&r.enabled&&console.assert!==t&&(console.assert(e,o),e||n("error",o))},r.dir=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.dir(e)},r.clear=function(e){i&&r.enabled&&(console.clear(e),r.output&&r.output.html(""))},r.trace=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.trace(e)},e.Debug=r}(window),function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),o=null,a=0,s=i.length;s>a;a++)o=i[a],this._listeners[o]=this._listeners[o]||[],-1===this._callbackIndex(o,t)&&this._listeners[o].push(t);else if("array"===n(t))for(var u=0,l=t.length;l>u;u++)this.on(e,t[u]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,o=r.length;o>i;i++)this.off(e,r[i]);else for(var a=e.split(" "),s=null,u=0,l=a.length;l>u;u++)if(s=a[u],this._listeners[s]=this._listeners[s]||[],r===t)this._listeners[s].length=0;else{var c=this._callbackIndex(s,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("Canteen").EventDispatcher=r}(window),$.fn.touch=function(e){return this.on("click",!1).on("touchclick",e)},$.fn.untouch=function(){return this.off("touchclick")},$.fn.internalLink=function(e){var t=Canteen.settings.basePath,n=Canteen.settings.siteIndex,r=e.currentState,i=function(e){if(e.hasClass("confirm")){var t=e.data("confirm")||"Are you sure you wish to continue?",n=confirm(t);return n}return!0};return this.each(function(){var o,a=$(this),s=a.data("refresh"),u=a.attr("href");if("undefined"!=typeof s)return a.untouch().touch(function(t){return i(a)?"soft"==s?(t.preventDefault(),e.refresh(),void 0):(u?document.location.href=u:e.refresh(!1),void 0):void 0}),void 0;if(u&&0===u.indexOf(t)){o=u.substr(t.length),a.untouch().touch(function(t){t.preventDefault(),i(a)&&e.redirect(o)}).removeClass("selected");var l=new RegExp("^"+o.replace("/","/")+"(/.*)?$");(o==r||""!==r&&l.test(r)||o==n&&""===r)&&a.addClass("selected")}})},function(){"use strict";var e=function(){},t=864e5;e.NEVER_EXPIRE="neverExpire",e.clear=function(t){e.write(t,"",-1)},e.write=function(n,r,i){var o,a;i?(i==e.NEVER_EXPIRE?a=new Date(2147483646e3):(a=new Date,a.setTime(a.getTime()+i*t)),o="; expires="+a.toGMTString()):o="",document.cookie=n+"="+r+o+"; path=/"},e.read=function(e){var t,n=e+"=",r=document.cookie.split(";"),i=0;for(i=0;i<r.length;i++){for(t=r[i];" "==t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(n))return t.substring(n.length,t.length)}return null},namespace("Canteen").SavedData=e}(),function(){"use strict";var e=function(){throw"Location Utils is a static class"};e.getParameters=function(){var e={},t=window.location.href,n=t.indexOf("?"),r=null,i=null,o=null,a=null,s=null;if(-1==n)return e;r=0>n?"":t.substr(n+1),i=r.indexOf("#"),r=0>i?r:r.substring(0,i),o=r.split("&");for(s in o)a=o[s].split("="),e[a[0]]=a[1];return e},namespace("Canteen").LocationUtils=e}(),function(e){"use strict";var t=function(){};t.ERROR="error",t.DISABLED="disabled",t.SELECTED="selected",t.REQUIRED="required",t.CONFIRM="confirm",t.FEEDBACK_ERROR="formError",t.FEEDBACK_SUCCESS="formSuccess",t.destroy=function(){$("input."+t.CONFIRM+", button."+t.CONFIRM).untouch(),$("form").resetForm().off("submit"),$(":submit").untouch()},t.setup=function(n,r){for(var i=new Array("text","button","reset","submit","checkbox","image","radio","file","password","date"),o=function(e){var t=$(e.target).closest("form"),n=t.find(":submit").eq(0);13==e.keyCode&&n&&(e.stopImmediatePropagation(),e.preventDefault(),n.trigger("touchclick"))},a=0,s=i.length;s>a;a++)$("input[type='"+i[a]+"']").removeClass(i[a]).addClass(i[a]).keyup(o);$("input."+t.CONFIRM+", button."+t.CONFIRM).untouch().touch(function(e){var n=$(this).data(t.CONFIRM)||"Are you sure you wish to continue?",r=confirm(n);return r?void 0:(e.stopImmediatePropagation(),!1)}),$('input[name="formSession"]').remove();var u=function(e,r){var i=r.find("."+t.REQUIRED).removeClass(t.ERROR),o=i.filter(function(){return!this.value}).addClass(t.ERROR);if(o.length>0){var a=function(){$(this).removeClass(t.ERROR).off("keydown")};return o.untouch().on("touchclick focus keydown",a),!1}for(var s={},u=0,l=e.length;l>u;u++)s[e[u].name]=e[u].value;return s.form?!0:(n.refresh(!0,s),!1)},l=function(r,i,o,a){if(-1==r.search(/^{.*}$/))return Debug.error(r),void 0;if(r=JSON.parse(r),"fatalError"==r.type)return Debug.fatalError(r),void 0;var s=a.find('input[name="refresh"]'),u=s.data("async");return r.redirect!==e?(n.redirect(r.redirect,!1,!0,u),void 0):!r.ifError&&s.length&&"true"==s.val()?(n.refresh(u),void 0):(t.formFeedback(a,r.messages,r.ifError),void 0)},c={data:{async:!0},beforeSubmit:u,success:l};$(":submit").touch(function(e){this.name&&this.value&&(c.data={async:!0},c.data[this.name]=this.value);var t=$(this).closest("form");t.length>0&&(e.preventDefault(),t.ajaxSubmit(c))}),$("form").on("submit",function(e){e.preventDefault(),$(this).ajaxSubmit(c)})},t.formFeedback=function(e,n,r){$("ul."+t.FEEDBACK_ERROR+", ul."+t.FEEDBACK_SUCCESS).remove();for(var i=r?t.FEEDBACK_ERROR:t.FEEDBACK_SUCCESS,o='<ul class="'+i+'">',a=0,s=n.length;s>a;a++)o+="<li>"+n[a]+"</li>";o+="</ul>";var u=e.find("legend");u.length?u.after(o):e.prepend(o)},namespace("Canteen").Forms=t}(),function(e){"use strict";var t=function(e,t){this.initialize(e,t)},n=t.prototype;n.gatewayUrl=null,n.initialize=function(e,t){this.gatewayUrl=e,"/"!=e.charAt(e.length-1)&&(this.gatewayUrl+="/"),this.get(function(e){var n=null===e||"error"==e.type;if(n)throw"Couldn't connect to gateway";t(!n)},"time","get-server-time")},n.get=function(t,n,r,i){var o=this.gatewayUrl+n+"/"+r;i!==e&&(o+="/"+($.isArray(i)?i.join("/"):String(i))),$.get(o,function(e){if(!e||"null"==e)return t(null),void 0;if(-1==e.search(/^{.*}$/))return Debug.error(e),t(null),void 0;var n=JSON.parse(e);return"fatalError"==n.type?(Debug.fatalError(n),t(null),void 0):(t(n),void 0)})},n.destroy=function(){n=null},namespace("Canteen").Gateway=t}(),function(){"use strict";var e=function(){},t=e.prototype;t.site=null,t.uri=null,t.enter=function(){},t.exit=function(){},t.refresh=function(){return!0},t.resize=function(){},namespace("Canteen").Page=e}(),function(e,t,n){"use strict";var r=Canteen.EventDispatcher,i=Canteen.LocationUtils,o=Canteen.Gateway,a=Canteen.Forms,s=Canteen.Page,u=function(){this.initialize()},l=u.prototype=new r,c=null,f=null,d=null,h=null,g=[],p=null,v={contentId:"#content",pageTitleId:"h1",pageLoadingId:"article",siteLoadingId:"body",loadingClass:"loading"};l.gateway=null,l.parameters=null,l.options={},u.ENTER="enter",u.EXIT="exit",u.READY="ready",u.LOADING="loading",u.LOADING_DONE="loadingDone",u.VERSION="1.0.0",l.initialize=function(){if(c)throw"Site has already been created. Use Canteen.Site.instance";c=this;var e=this.options=v;(Canteen.settings.clientEnabled===n||Canteen.settings.clientEnabled)&&(t(e.siteLoadingId).addClass(e.loadingClass),this.parameters=i.getParameters(),Debug.enabled=Canteen.settings.debug,d=1,h=Canteen.settings.uriRequest,this._enableHistory(!0),this._fixInternalLinks(),this.gateway=new o(Canteen.settings.gatewayPath,this._gatewayReady.bind(this)))},l._enableHistory=function(n){t(e).off("statechange"),n&&t(e).on("statechange",this._onStateChange.bind(this))},l.redirect=function(e,r,i,o){var a=Canteen.settings.basePath,s=t("<div />").html(t("title").html()).text();return r=r===n?!1:r,i=i===n?!1:i,o=o===n?!0:o,Canteen.settings.siteIndex!=e&&(a+=e),h==e?(i&&this.refresh(o),void 0):(r?History.replaceState({state:d},s,a):(d++,History.pushState({state:d},s,a)),void 0)},Object.defineProperty(u,"instance",{get:function(){return c}}),Object.defineProperty(l,"currentState",{get:function(){return h}}),Object.defineProperty(l,"currentPage",{get:function(){return p}}),l.refresh=function(e,t){e=e===n?!0:e,e?this._updatePageContent(h,t):document.location.reload(!0)},l._fixInternalLinks=function(){t("a").internalLink(this),a.setup(this,"true"===this.parameters.debugForms)},l._onStateChange=function(){var e=History.getState(),t=e.url.split(Canteen.settings.baseUrl)[1];h!=t&&this._updatePageContent(t)},l._gatewayReady=function(e){e||Debug.error("Unable to setup gateway.");var n=this.options;t(n.siteLoadingId).removeClass(n.loadingClass),t(window).on("resize",this.resize.bind(this)),this.resize(),this.trigger(u.READY),this._enterPage()},l.resize=function(){p&&p.resize()},l.addPage=function(e,t){t instanceof s?(t.site=this,g.push({uri:e,content:t})):Debug.warn("The page your trying to add needs to extend Canteen.Page")},l._enterPage=function(){var e=this.getPageByUri(h);e&&(p=e.content,p.uri=h,p.enter(),p.resize()),this.trigger(u.ENTER,h)},l.getPageByUri=function(e){var t=g.length,n=0,r=null;if(0===t)return null;for(n=0;t>n;n++)if(r=g[n],r.uri===e||r.uri instanceof RegExp&&r.uri.test(e))return r;return null},l._updatePageContent=function(e,r){var i=this,o=this.options,s=this.getPageByUri(e),l=Canteen.settings.baseUrl+e;return this.trigger(u.EXIT,h),h=e,s&&s.content===p&&!s.content.refresh(e)?(s.content.uri=e,void 0):(p&&(p.exit(),p=null),a.destroy(),f=e,r=r===n?{}:r,r.async=!0,this.trigger(u.LOADING),t(o.pageLoadingId).removeClass(o.loadingClass).addClass(o.loadingClass),t.post(l,r,function(r){if(e==f){if(f=null,i.trigger(u.LOADING_DONE),t(o.pageLoadingId).removeClass(o.loadingClass),!r||"null"==r)return Debug.error("No data for "+e),void 0;if(-1==r.search(/^{.*}$/))return Debug.error(r),void 0;var a=JSON.parse(r);if("fatalError"==a.type)return Debug.fatalError(a),void 0;if(a.redirect!==n)return i.redirect(a.redirect,!0),void 0;t("body").attr("id",a.pageId),t(o.pageTitleId).html(a.title),t(o.contentId).html(a.content),document.title=t("<div />").html(a.fullTitle).text(),t("meta[name='keywords']").attr("content",a.keywords),t("meta[name='description']").attr("content",a.description),i._fixInternalLinks(),i._enterPage()}}),void 0)},namespace("Canteen").Site=u,t(function(){new u})}(window,jQuery);