(function(){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){var t,n,r=this;if("function"!=typeof r)throw new TypeError;return t=Array.prototype.slice.call(arguments,1),n=function(){if(this instanceof n){var i,a,s;return i=function(){},i.prototype=r.prototype,a=new i,s=r.apply(a,t.concat(Array.prototype.slice.call(arguments))),Object(s)===s?s:a}return r.apply(e,t.concat(Array.prototype.slice.call(arguments)))}})})(),function(e){"use strict";var t=function(e){var t=e.split("."),n=window,r="",i=0,a=0;for(i=0,a=t.length;a>i;i++)r=t[i],n[r]=n[r]||{},n=n[r];return n};e.namespace=t}(window),function(e,t){"use strict";function n(e,t){r.output&&r.output.append('<div class="'+e+'">'+t+"</div>")}var r=function(){},i=e.console!==t;r.GENERAL=0,r.DEBUG=1,r.INFO=2,r.WARN=3,r.ERROR=4,r.minLogLevel=r.GENERAL,r.enabled=!0,r.output=null,r.log=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&(console.log(e),n("general",e))},r.debug=function(e){r.minLogLevel<=r.DEBUG&&i&&r.enabled&&(console.debug(e),n("debug",e))},r.info=function(e){r.minLogLevel<=r.INFO&&i&&r.enabled&&(console.info(e),n("info",e))},r.warn=function(e){r.minLogLevel<=r.WARN&&i&&r.enabled&&(console.warn(e),n("warn",e))},r.error=function(e){i&&r.enabled&&(console.error(e),n("error",e))},r.fatalError=function(e){var t=e.message+"\non "+e.file+" (code: "+e.code+")\n";if(e.stackTrace)for(var n=0;e.stackTrace.length>n;n++)t+="\n	 #"+(n+1)+". "+e.stackTrace[n];r.error(t)},r.assert=function(e,a){i&&r.enabled&&console.assert!==t&&(console.assert(e,a),e||n("error",a))},r.dir=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.dir(e)},r.clear=function(e){i&&r.enabled&&(console.clear(e),r.output&&r.output.html(""))},r.trace=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.trace(e)},e.Debug=r}(window),function(e,t){"use strict";function n(e){return null===e?e+"":"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;r.length>i;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),a=null,s=0,o=i.length;o>s;s++)a=i[s],this._listeners[a]=this._listeners[a]||[],-1===this._callbackIndex(a,t)&&this._listeners[a].push(t);else if("array"===n(t))for(var l=0,u=t.length;u>l;l++)this.on(e,t[l]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,a=r.length;a>i;i++)this.off(e,r[i]);else for(var s=e.split(" "),o=null,l=0,u=s.length;u>l;l++)if(o=s[l],this._listeners[o]=this._listeners[o]||[],r===t)this._listeners[o].length=0;else{var c=this._callbackIndex(o,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("Canteen").EventDispatcher=r}(window),$.fn.touch=function(e){return this.on("click",!1).on("touchclick",e)},$.fn.untouch=function(){return this.off("touchclick")},$.fn.internalLink=function(e){var t=Canteen.settings.basePath,n=Canteen.settings.siteIndex,r=e.currentState,i=function(e){if(e.hasClass("confirm")){var t=e.data("confirm")||"Are you sure you wish to continue?",n=confirm(t);return n}return!0};return this.each(function(){var a,s=$(this),o=s.data("refresh"),l=s.attr("href");return o!==void 0?(s.untouch().touch(function(t){return i(s)?"soft"==o?(t.preventDefault(),e.refresh(),void 0):(l?document.location.href=l:e.refresh(!1),void 0):void 0}),void 0):(l&&0===l.indexOf(t)&&(a=l.substr(t.length),s.untouch().touch(function(t){t.preventDefault(),i(s)&&e.redirect(a)}).removeClass("selected"),(a==r||0===r.indexOf(a)||a==n&&""===r)&&s.addClass("selected")),void 0)})},function(){"use strict";var e=function(){},t=864e5;e.NEVER_EXPIRE="neverExpire",e.clear=function(t){e.write(t,"",-1)},e.write=function(n,r,i){var a,s;i?(i==e.NEVER_EXPIRE?s=new Date(2147483646e3):(s=new Date,s.setTime(s.getTime()+i*t)),a="; expires="+s.toGMTString()):a="",document.cookie=n+"="+r+a+"; path=/"},e.read=function(e){var t,n=e+"=",r=document.cookie.split(";"),i=0;for(i=0;r.length>i;i++){for(t=r[i];" "==t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(n))return t.substring(n.length,t.length)}return null},namespace("Canteen").SavedData=e}(),function(){"use strict";var e=function(){throw"Location Utils is a static class"};e.getParameters=function(){var e={},t=window.location.href,n=t.indexOf("?"),r=null,i=null,a=null,s=null,o=null;if(-1==n)return e;r=0>n?"":t.substr(n+1),i=r.indexOf("#"),r=0>i?r:r.substring(0,i),a=r.split("&");for(o in a)s=a[o].split("="),e[s[0]]=s[1];return e},namespace("Canteen").LocationUtils=e}(),function(e){"use strict";var t=function(){};t.ERROR="error",t.DISABLED="disabled",t.SELECTED="selected",t.OVER="over",t.REQUIRED="required",t.FEEDBACK_ERROR="formError",t.FEEDBACK_SUCCESS="formSuccess",t.setup=function(e){var n,r=["text","button","reset","submit","checkbox","image","radio","file","password","date"],i=r.length,a=function(){$(this).attr("disabled")||$(this).addClass(Canteen.OVER)},s=function(){$(this).removeClass(Canteen.OVER)},o=function(e){var t=$(this).closest("form"),n=t.find(":submit, :button").eq(0);13==e.keyCode&&t.length>0&&(e.preventDefault(),n&&t.data("clicked",n),t.submit())};for(n=0;i>n;n++){var l=$("input[type='"+r[n]+"']").removeClass(r[n]).addClass(r[n]).hover(s,a).keydown(o);l.prop("disabled")&&l.data("disabled",!0)}$("form").each(function(){var n=$(this);n.find(":submit, :button").touch(function(){var e=$(this);if(n.data("clicked",e),e.hasClass("confirm")){var t=e.data("confirm")||"Are you sure you wish to continue?",r=confirm(t);if(!r)return}n.submit()}),n.submit(function(n){var r,i=$(this),a=i.find("."+t.REQUIRED);a.removeClass(t.ERROR),r=a.filter(function(){return!this.value}).addClass(t.ERROR),r.length>0?r.untouch().touch(function(){$(this).removeClass(t.ERROR)}):t.handleSubmit(e,i),n.preventDefault()})})},t.handleSubmit=function(n,r){var i,a,s={},o=r.find("input,textarea,select");r.data("clicked")&&(a=r.data("clicked"),s[a.attr("name")]=a.val()),o.each(function(){a=$(this),i=a.attr("name"),i!==e&&"formSession"!=i&&(a.is(":checkbox")?a.is(":checked")&&("[]"==i.substr(-2)?(i=i.replace("[]",""),s[i]===e?s[i]=[a.val()]:s[i].push(a.val())):s[i]=a.val()):a.is(":submit")||a.is(":button")||(a.is(":radio")?a.is(":checked")&&(s[i]=a.val()):s[i]=a.val()))}).enabled(!1),s.form===e?n.refresh(!0,s):t.async(s,function(i){return i.redirect?(n.redirect(i.redirect,!1,!0),e):("true"==s.refresh?n.refresh():(t.formFeedback(r,i.messages,!1),r.trigger({type:t.FEEDBACK_SUCCESS,params:s,feedback:i.messages}),o.enabled(!0)),e)},function(i){return i.redirect?(n.redirect(i.redirect,!1,!0),e):(t.formFeedback(r,i.messages,!0),r.trigger({type:t.FEEDBACK_ERROR,params:s,feedback:i.messages}),o.enabled(!0),e)})},t.formFeedback=function(e,n,r){$("ul."+t.FEEDBACK_ERROR+", ul."+t.FEEDBACK_SUCCESS).remove();var i,a,s=0,o=n.length,l=$("<ul></ul>");for(l.addClass(r?t.FEEDBACK_ERROR:t.FEEDBACK_SUCCESS),s=0;o>s;s++)i=$("<li></li>").text(n[s]),l.append(i);a=e.find("legend"),a.length?a.after(l):e.prepend(l)},t.async=function(t,n,r){t.async="true",$.post(window.location.href,t,function(t){return-1==t.search(/^{.*}$/)?(Debug.error(t),e):(t=JSON.parse(t),"fatalError"==t.type?(Debug.fatalError(t),e):(t.ifError?r!==e&&r(t):n!==e&&n(t),e))})},$.fn.enabled=function(e){return this.each(function(){var n=$(this),r=n.data("disabled");n.prop("disabled",!e),e?r||n.removeClass(t.DISABLED):n.addClass(t.DISABLED)})},namespace("Canteen").Forms=t}(),function(e){"use strict";var t=function(e,t){this.initialize(e,t)},n=t.prototype;n.gatewayUrl=null,n.initialize=function(e,t){this.gatewayUrl=e,"/"!=e.charAt(e.length-1)&&(this.gatewayUrl+="/"),this.get(function(e){var n=null===e||"error"==e.type;if(n)throw"Couldn't connect to gateway";t(!n)},"time","get-server-time")},n.get=function(t,n,r,i){var a=this.gatewayUrl+n+"/"+r;i!==e&&(a+="/"+($.isArray(i)?i.join("/"):i+"")),$.get(a,function(n){if(!n||"null"==n)return t(null),e;if(-1==n.search(/^{.*}$/))return Debug.error(n),t(null),e;var r=JSON.parse(n);return"fatalError"==r.type?(Debug.fatalError(r),t(null),e):(t(r),e)})},n.destroy=function(){n=null},namespace("Canteen").Gateway=t}(),function(){"use strict";var e=function(){},t=e.prototype;t.site=null,t.uri=null,t.enter=function(){},t.exit=function(){},t.refresh=function(){return!0},t.resize=function(){},namespace("Canteen").Page=e}(),function(e,t){"use strict";var n=Canteen.EventDispatcher,r=Canteen.LocationUtils,i=Canteen.Gateway,a=Canteen.Forms,s=Canteen.Page,o=function(e){this.initialize(e)},l=o.prototype=new n,u=null,c=null,f=null,d=[],h=null,g={contentId:"#content",pageTitleId:"h1",pageLoadingId:"article",siteLoadingId:"body",loadingClass:"loading"};l.gateway=null,l.parameters=null,l.options={},o.ENTER="enter",o.EXIT="exit",o.READY="ready",o.LOADING="loading",o.LOADING_DONE="loadingDone",o.VERSION="1.0.0",l.initialize=function(e){var n=$.extend(this.options,g,e);(Canteen.settings.clientEnabled===t||Canteen.settings.clientEnabled)&&($(n.siteLoadingId).addClass(n.loadingClass),this.parameters=r.getParameters(),Debug.enabled=Canteen.settings.debug,c=1,f=Canteen.settings.uriRequest,this._enableHistory(!0),this._fixInternalLinks(),this.gateway=new i(Canteen.settings.gatewayPath,this._gatewayReady.bind(this)))},l._enableHistory=function(t){$(e).off("statechange"),t&&$(e).on("statechange",this._onStateChange.bind(this))},l.redirect=function(e,n,r){var i=Canteen.settings.basePath,a=$("<div />").html($("title").html()).text();return n=n===t?!1:n,r=r===t?!1:r,Canteen.settings.siteIndex!=e&&(i+=e),f==e?(r&&this.refresh(),t):(n?History.replaceState({state:c},a,i):(c++,History.pushState({state:c},a,i)),t)},Object.defineProperty(l,"currentState",{get:function(){return f}}),Object.defineProperty(l,"currentPage",{get:function(){return h}}),l.refresh=function(e,n){e=e===t?!0:e,e?this._updatePageContent(f,n):document.location.reload(!0)},l._fixInternalLinks=function(){$("a").internalLink(this),a.setup(this)},l._onStateChange=function(){var e=History.getState(),t=e.url.split(Canteen.settings.baseUrl)[1];f!=t&&this._updatePageContent(t)},l._gatewayReady=function(e){e||Debug.error("Unable to setup gateway.");var t=this.options;$(t.siteLoadingId).removeClass(t.loadingClass),$(window).on("resize",this.resize.bind(this)),this.resize(),this.trigger(o.READY),this._enterPage()},l.resize=function(){h&&h.resize()},l.addPage=function(e,t){t instanceof s?(t.site=this,d.push({uri:e,content:t})):Debug.warn("The page your trying to add needs to extend Canteen.Page")},l._enterPage=function(){var e=this.getPageByUri(f);e&&(h=e.content,h.uri=f,h.enter(),h.resize()),this.trigger(o.ENTER,f)},l.getPageByUri=function(e){var t=d.length,n=0,r=null;if(0===t)return null;for(n=0;t>n;n++)if(r=d[n],r.uri===e||r.uri instanceof RegExp&&r.uri.test(e))return r;return null},l._updatePageContent=function(e,n){var r=this,i=this.options,a=this.getPageByUri(e),s=Canteen.settings.baseUrl+e;return this.trigger(o.EXIT,f),f=e,a&&a.content===h&&!a.content.refresh(e)?(a.content.uri=e,t):(h&&(h.exit(),h=null),u=e,n=n===t?{}:n,n.async=!0,this.trigger(o.LOADING),$(i.pageLoadingId).removeClass(i.loadingClass).addClass(i.loadingClass),$.post(s,n,function(n){if(e==u){if(u=null,r.trigger(o.LOADING_DONE),$(i.pageLoadingId).removeClass(i.loadingClass),!n||"null"==n)return Debug.error("No data for "+e),t;if(-1==n.search(/^{.*}$/))return Debug.error(n),t;var a=JSON.parse(n);if("fatalError"==a.type)return Debug.fatalError(a),t;if(a.redirect!==t)return r.redirect(a.redirect,!0),t;$("body").attr("id",a.pageId),$(i.pageTitleId).html(a.title),$(i.contentId).html(a.content),document.title=$("<div />").html(a.fullTitle).text(),$("meta[name='keywords']").attr("content",a.keywords),$("meta[name='description']").attr("content",a.description),r._fixInternalLinks(),r._enterPage()}}),t)},namespace("Canteen").Site=o}(window);