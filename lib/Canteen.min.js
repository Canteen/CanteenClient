(function(){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){var t,n,r=this;if("function"!=typeof r)throw new TypeError;return t=Array.prototype.slice.call(arguments,1),n=function(){if(this instanceof n){var i,a,o;return i=function(){},i.prototype=r.prototype,a=new i,o=r.apply(a,t.concat(Array.prototype.slice.call(arguments))),Object(o)===o?o:a}return r.apply(e,t.concat(Array.prototype.slice.call(arguments)))}})})(),function(e){"use strict";var t=function(e){var t=e.split("."),n=window,r="",i=0,a=0;for(i=0,a=t.length;a>i;i++)r=t[i],n[r]=n[r]||{},n=n[r];return n};e.namespace=t}(window),function(e,t){"use strict";function n(e){return null===e?e+"":"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}var r=function(){},i=r.prototype;i._listeners=[],i.trigger=function(e,n){if(this._listeners[e]!==t)for(var r=this._listeners[e],i=0;r.length>i;i++)r[i](n)},i.on=function(e,t){if("object"===n(e))for(var r in e)e.hasOwnProperty(r)&&this.on(r,e[r]);else if("function"===n(t))for(var i=e.split(" "),a=null,o=0,s=i.length;s>o;o++)a=i[o],this._listeners[a]=this._listeners[a]||[],-1===this._callbackIndex(a,t)&&this._listeners[a].push(t);else if("array"===n(t))for(var u=0,l=t.length;l>u;u++)this.on(e,t[u]);return this},i.off=function(e,r){if(e===t)this._listeners=[];else if("array"===n(r))for(var i=0,a=r.length;a>i;i++)this.off(e,r[i]);else for(var o=e.split(" "),s=null,u=0,l=o.length;l>u;u++)if(s=o[u],this._listeners[s]=this._listeners[s]||[],r===t)this._listeners[s].length=0;else{var c=this._callbackIndex(s,r);-1!==c&&this._listeners[e].splice(c,1)}return this},i._callbackIndex=function(e,t){for(var n=0,r=this._listeners[e].length;r>n;n++)if(this._listeners[e][n]===t)return n;return-1},namespace("Canteen").EventDispatcher=r}(window),function(e,t){"use strict";function n(e,t){r.output&&r.output.append('<div class="'+e+'">'+t+"</div>")}var r=function(){},i=e.console!==t;r.GENERAL=0,r.DEBUG=1,r.INFO=2,r.WARN=3,r.ERROR=4,r.minLogLevel=r.GENERAL,r.enabled=!0,r.output=null,r.log=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&(console.log(e),n("general",e))},r.debug=function(e){r.minLogLevel<=r.DEBUG&&i&&r.enabled&&(console.debug(e),n("debug",e))},r.info=function(e){r.minLogLevel<=r.INFO&&i&&r.enabled&&(console.info(e),n("info",e))},r.warn=function(e){r.minLogLevel<=r.WARN&&i&&r.enabled&&(console.warn(e),n("warn",e))},r.error=function(e){i&&r.enabled&&(console.error(e),n("error",e))},r.fatalError=function(e){if(result=e.message+"\non "+e.file+" (code: "+e.code+")\n",e.stackTrace)for(var t=0;e.stackTrace.length>t;t++)result+="	 #"+(t+1)+". "+e.stackTrace[t];r.error(result)},r.assert=function(e,a){i&&r.enabled&&console.assert!==t&&(console.assert(e,a),e||n("error",a))},r.dir=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.dir(e)},r.clear=function(e){i&&r.enabled&&(console.clear(e),r.output&&r.output.html(""))},r.trace=function(e){r.minLogLevel==r.GENERAL&&i&&r.enabled&&console.trace(e)},e.Debug=r}(window),$.event.special.touch={setup:function(){var e="ontouchend"in document?"touchend":"mouseup",t=void 0===$.event.handle?$.event.dispatch:$.event.handle;$(this).on(e+".touch",function(e){e.type="touch",t.call(this,e)})},teardown:function(){$(this).off(".touch")}},$.fn.touch=function(e){return this.click(!1).on("touch",e)},$.fn.untouch=function(){return this.off("touch")},$.fn.internalLink=function(e){var t=Canteen.settings.basePath,n=Canteen.settings.siteIndex,r=e.currentState,i=function(e){if(e.hasClass("confirm")){var t=e.data("confirm")||"Are you sure you wish to continue?",n=confirm(t);return n}return!0};return this.each(function(){var a,o=$(this),s=o.data("refresh"),u=o.attr("href");return s!==void 0?(o.untouch().touch(function(t){return i(o)?"soft"==s?(t.preventDefault(),e.refresh(),void 0):(u?document.location.href=u:e.refresh(!1),void 0):void 0}),void 0):(u&&0===u.indexOf(t)&&(a=u.substr(t.length),o.untouch().touch(function(t){t.preventDefault(),i(o)&&e.redirect(a)}).removeClass("selected"),(a==r||0===r.indexOf(a)||a==n&&""===r)&&o.addClass("selected")),void 0)})},function(){"use strict";var e=function(){},t=864e5;e.NEVER_EXPIRE="neverExpire",e.clear=function(t){e.write(t,"",-1)},e.write=function(n,r,i){var a,o;i?(i==e.NEVER_EXPIRE?o=new Date(2147483646e3):(o=new Date,o.setTime(o.getTime()+i*t)),a="; expires="+o.toGMTString()):a="",document.cookie=n+"="+r+a+"; path=/"},e.read=function(e){var t,n=e+"=",r=document.cookie.split(";"),i=0;for(i=0;r.length>i;i++){for(t=r[i];" "==t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(n))return t.substring(n.length,t.length)}return null},namespace("Canteen").SavedData=e}(),function(){"use strict";var e=function(){throw"Location Utils is a static class"};e.getParameters=function(){var e={},t=window.location.href,n=t.indexOf("?"),r=null,i=null,a=null,o=null,s=null;if(-1==n)return e;r=0>n?"":t.substr(n+1),i=r.indexOf("#"),r=0>i?r:r.substring(0,i),a=r.split("&");for(s in a)o=a[s].split("="),e[o[0]]=o[1];return e},namespace("Canteen").LocationUtils=e}(),function(e){"use strict";var t=function(){};t.ERROR="error",t.DISABLED="disabled",t.SELECTED="selected",t.OVER="over",t.REQUIRED="required",t.FEEDBACK_ERROR="formError",t.FEEDBACK_SUCCESS="formSuccess",t.setup=function(e){var n,r=["text","button","reset","submit","checkbox","image","radio","file","password","date"],i=r.length,a=function(){$(this).attr("disabled")||$(this).addClass(Canteen.OVER)},o=function(){$(this).removeClass(Canteen.OVER)},s=function(e){var t=$(this).closest("form"),n=t.find(":submit, :button").eq(0);13==e.keyCode&&t.length>0&&(e.preventDefault(),n&&t.data("clicked",n),t.submit())};for(n=0;i>n;n++){var u=$("input[type='"+r[n]+"']").removeClass(r[n]).addClass(r[n]).hover(o,a).keydown(s);u.prop("disabled")&&u.data("disabled",!0)}$("form").each(function(){var n=$(this);n.find(":submit, :button").touch(function(){var e=$(this);if(n.data("clicked",e),e.hasClass("confirm")){var t=e.data("confirm")||"Are you sure you wish to continue?",r=confirm(t);if(!r)return}n.submit()}),n.submit(function(n){var r,i=$(this),a=i.find("."+t.REQUIRED);a.removeClass(t.ERROR),r=a.filter(function(){return!this.value}).addClass(t.ERROR),r.length>0?r.untouch().touch(function(){$(this).removeClass(t.ERROR)}):t.handleSubmit(e,i),n.preventDefault()})})},t.handleSubmit=function(n,r){var i,a,o={},s=r.find("input,textarea,select");r.data("clicked")&&(a=r.data("clicked"),o[a.attr("name")]=a.val()),s.each(function(){a=$(this),i=a.attr("name"),i!==e&&"formSession"!=i&&(a.is(":checkbox")?a.is(":checked")&&("[]"==i.substr(-2)?(i=i.replace("[]",""),o[i]===e?o[i]=[a.val()]:o[i].push(a.val())):o[i]=a.val()):a.is(":submit")||a.is(":button")||(a.is(":radio")?a.is(":checked")&&(o[i]=a.val()):o[i]=a.val()))}).enabled(!1),o.form===e?n.refresh(!0,o):t.async(o,function(i){return i.redirect?(n.redirect(i.redirect,!1,!0),e):("true"==o.refresh?n.refresh():(t.formFeedback(r,i.messages,!1),r.trigger({type:t.FEEDBACK_SUCCESS,params:o,feedback:i.messages}),s.enabled(!0)),e)},function(i){return i.redirect?(n.redirect(i.redirect,!1,!0),e):(t.formFeedback(r,i.messages,!0),r.trigger({type:t.FEEDBACK_ERROR,params:o,feedback:i.messages}),s.enabled(!0),e)})},t.formFeedback=function(e,n,r){$("ul."+t.FEEDBACK_ERROR+", ul."+t.FEEDBACK_SUCCESS).remove();var i,a,o=0,s=n.length,u=$("<ul></ul>");for(u.addClass(r?t.FEEDBACK_ERROR:t.FEEDBACK_SUCCESS),o=0;s>o;o++)i=$("<li></li>").text(n[o]),u.append(i);a=e.find("legend"),a.length?a.after(u):e.prepend(u)},t.async=function(t,n,r){t.async="true",$.post(window.location.href,t,function(t){return-1==t.search(/^{.*}$/)?(Debug.error(t),e):(t=JSON.parse(t),"fatalError"==t.type?(Debug.fatalError(t.errors),e):(t.ifError?r!==e&&r(t):n!==e&&n(t),e))})},$.fn.enabled=function(e){return this.each(function(){var n=$(this),r=n.data("disabled");n.prop("disabled",!e),e?r||n.removeClass(t.DISABLED):n.addClass(t.DISABLED)})},namespace("Canteen").Forms=t}(),function(e){"use strict";var t=function(e,t){this.initialize(e,t)},n=t.prototype;n.gatewayUrl=null,n.initialize=function(e,t){this.gatewayUrl=e,"/"!=e.charAt(e.length-1)&&(this.gatewayUrl+="/"),this.get(function(e){var n=null===e||"error"==e.type;if(n)throw"Couldn't connect to gateway";t(!n)},"time","get-server-time")},n.get=function(t,n,r,i){var a=this.gatewayUrl+n+"/"+r;i!==e&&(a+="/"+($.isArray(i)?i.join("/"):i+"")),$.get(a,function(n){if(!n||"null"==n)return t(null),e;if(-1==n.search(/^{.*}$/))return Debug.error(n),t(null),e;var r=JSON.parse(n);return"fatalError"==r.type?(Debug.fatalError(r.errors),t(null),e):(t(r),e)})},n.destroy=function(){n=null},namespace("Canteen").Gateway=t}(),function(){"use strict";var e=function(){},t=e.prototype;t.site=null,t.uri=null,t.enter=function(){},t.exit=function(){},t.refresh=function(){return!0},t.resize=function(){},namespace("Canteen").Page=e}(),function(e,t){"use strict";var n=Canteen.EventDispatcher,r=Canteen.LocationUtils,i=Canteen.Gateway,a=Canteen.Forms,o=Canteen.Page,s=function(e){this.initialize(e)},u=s.prototype=new n,l=null,c=null,f=null,d=[],h=null,g={contentId:"#content",pageTitleId:"h1",pageLoadingId:"article",siteLoadingId:"body",loadingClass:"loading"};u.gateway=null,u.parameters=null,u.options={},s.ENTER="enter",s.EXIT="exit",s.READY="ready",s.LOADING="loading",s.LOADING_DONE="loadingDone",s.VERSION="1.0.0",u.initialize=function(e){var t=$.extend(this.options,g,e);$(t.siteLoadingId).addClass(t.loadingClass),c=1,f=Canteen.settings.uriRequest,this._enableHistory(!0),this._fixInternalLinks(),Debug.enabled=Canteen.settings.debug,this.parameters=r.getParameters(),this.gateway=new i(Canteen.settings.gatewayPath,this._gatewayReady.bind(this))},u._enableHistory=function(t){$(e).off("statechange"),t&&$(e).on("statechange",this._onStateChange.bind(this))},u.redirect=function(e,n,r){var i=Canteen.settings.basePath,a=$("title").html();return n=n===t?!1:n,r=r===t?!1:r,Canteen.settings.siteIndex!=e&&(i+=e),f==e?(r&&this.refresh(),t):(n?History.replaceState({state:c},a,i):(c++,History.pushState({state:c},a,i)),t)},Object.defineProperty(u,"currentState",{get:function(){return f}}),Object.defineProperty(u,"currentPage",{get:function(){return h}}),u.refresh=function(e,n){e=e===t?!0:e,e?this._updatePageContent(f,n):document.location.reload(!0)},u._fixInternalLinks=function(){$("a").internalLink(this),a.setup(this)},u._onStateChange=function(){var e=History.getState(),t=e.url.split(Canteen.settings.baseUrl)[1];f!=t&&this._updatePageContent(t)},u._gatewayReady=function(e){e||Debug.error("Unable to setup gateway.");var t=this.options;$(t.siteLoadingId).removeClass(t.loadingClass),$(window).on("resize",this.resize.bind(this)),this.resize(),this.trigger(s.READY),this._enterPage()},u.resize=function(){h&&h.resize()},u.addPage=function(e,t){t instanceof o?(t.site=this,d.push({uri:e,content:t})):Debug.warn("The page your trying to add needs to extend Canteen.Page")},u._enterPage=function(){var e=this.getPageByUri(f);e&&(h=e.content,h.uri=f,h.enter(),h.resize()),this.trigger(s.ENTER,f)},u.getPageByUri=function(e){var t=d.length,n=0,r=null;if(0===t)return null;for(n=0;t>n;n++)if(r=d[n],r.uri===e||r.uri instanceof RegExp&&r.uri.test(e))return r;return null},u._updatePageContent=function(e,n){var r=this,i=this.options,a=this.getPageByUri(e),o=Canteen.settings.baseUrl+e;return this.trigger(s.EXIT,f),f=e,a&&a.content===h&&!a.content.refresh(e)?(a.content.uri=e,t):(h&&(h.exit(),h=null),l=e,n=n===t?{}:n,n.async=!0,this.trigger(s.LOADING),$(i.pageLoadingId).removeClass(i.loadingClass).addClass(i.loadingClass),$.post(o,n,function(n){if(e==l){if(l=null,r.trigger(s.LOADING_DONE),$(i.pageLoadingId).removeClass(i.loadingClass),"null"==n)return Debug.error("No data for "+e),t;if(-1==n.search(/^{.*}$/))return Debug.error(n),t;var a=JSON.parse(n);if("fatalError"==a.type)return Debug.fatalError(a),t;if(a.redirect!==t)return r.redirect(a.redirect,!0),t;$("body").attr("id",a.pageId),$(i.pageTitleId).html(a.title),$(i.contentId).html(a.content),document.title=a.fullTitle,$("meta[name='keywords']").attr("content",a.keywords),$("meta[name='description']").attr("content",a.description),r._fixInternalLinks(),r._enterPage()}}),t)},namespace("Canteen").Site=s}(window);